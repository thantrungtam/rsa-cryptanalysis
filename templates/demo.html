{% extends "base.html" %}

{% block title %}Demo - RSA Cryptanalysis Demo{% endblock %}

{% block content %}
<style>
    /* Force CSS refresh and fix display issues */
    .key-value,
    .step-math {
        overflow: visible !important;
        max-height: none !important;
        height: auto !important;
        min-height: auto !important;
        word-wrap: break-word !important;
        white-space: pre-wrap !important;
    }

    .key-display,
    .result-section,
    .steps-container {
        overflow: visible !important;
        max-height: none !important;
        height: auto !important;
        width: 100% !important;
        max-width: 100% !important;
    }
</style>
<div class="demo-container">
    <h1>üî¨ Demo RSA Cryptanalysis</h1>
    <p>Th·ª±c h√†nh c√°c ch·ª©c nƒÉng RSA v√† m√¥ ph·ªèng t·∫•n c√¥ng</p>

    <div class="tabs">
        <button class="tab-button active" data-tab="keygen-tab">üîë Sinh kh√≥a</button>
        <button class="tab-button" data-tab="encrypt-tab">üîí M√£ h√≥a</button>
        <button class="tab-button" data-tab="decrypt-tab">üîì Gi·∫£i m√£</button>
        <button class="tab-button" data-tab="attack-single-tab">üéØ T·∫•n c√¥ng khai cƒÉn</button>
        <button class="tab-button" data-tab="hastad-tab">üö® T·∫•n c√¥ng H√•stad</button>
    </div>

    <!-- Tab Sinh kh√≥a -->
    <div id="keygen-tab" class="tab-content active">
        <h2>üîë Sinh kh√≥a RSA</h2>
        <p>T·∫°o c·∫∑p kh√≥a RSA v·ªõi tham s·ªë t√πy ch·ªânh</p>

        <div class="form-group">
            <label class="form-label" for="exponent">S·ªë m≈© c√¥ng khai (e):</label>
            <select id="exponent" class="form-select">
                <option value="3">3 (Nguy hi·ªÉm - d·ªÖ b·ªã t·∫•n c√¥ng)</option>
                <option value="5">5</option>
                <option value="17">17</option>
                <option value="65537">65537 (Khuy·∫øn ngh·ªã)</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label" for="key-bits">ƒê·ªô d√†i kh√≥a (bits):</label>
            <select id="key-bits" class="form-select">
                <option value="512">512 (Kh√¥ng an to√†n - ch·ªâ ƒë·ªÉ demo)</option>
                <option value="1024" selected>1024</option>
                <option value="2048">2048</option>
            </select>
        </div>

        <button id="generate-key-btn" class="btn btn-primary">Sinh kh√≥a</button>

        <div id="key-loading" class="loading">
            <div class="spinner"></div>
            <p>ƒêang sinh kh√≥a RSA...</p>
        </div>

        <div id="key-result" class="result-section" style="display: none;"></div>
    </div>

    <!-- Tab M√£ h√≥a -->
    <div id="encrypt-tab" class="tab-content">
        <h2>üîí M√£ h√≥a RSA</h2>
        <p>M√£ h√≥a b·∫£n r√µ v·ªõi kh√≥a c√¥ng khai</p>

        <div class="form-group">
            <label class="form-label" for="encrypt-message">B·∫£n r√µ:</label>
            <input type="text" id="encrypt-message" class="form-input"
                placeholder="Nh·∫≠p th√¥ng ƒëi·ªáp c·∫ßn m√£ h√≥a (v√≠ d·ª•: Hello)" value="Hi">
            <small class="form-help">
                üí° Nh·∫≠p vƒÉn b·∫£n ƒë·ªÉ m√£ h√≥a (v√≠ d·ª•: Hello, Secret message)
            </small>
        </div>

        <div class="form-group">
            <label class="form-label" for="encrypt-n">Modulus (n):</label>
            <textarea id="encrypt-n" class="form-textarea" placeholder="Nh·∫≠p modulus n t·ª´ kh√≥a c√¥ng khai"></textarea>
        </div>

        <div class="form-group">
            <label class="form-label" for="encrypt-e">S·ªë m≈© c√¥ng khai (e):</label>
            <input type="text" id="encrypt-e" class="form-input" placeholder="Nh·∫≠p s·ªë m≈© c√¥ng khai e" value="3">
        </div>

        <div class="form-group">
            <label class="form-label" for="encrypt-padding">Lo·∫°i Padding:</label>
            <select id="encrypt-padding" class="form-select">
                <option value="raw" selected>Raw RSA (Kh√¥ng padding - d·ªÖ b·ªã t·∫•n c√¥ng)</option>
                <option value="pkcs1_v1_5">PKCS#1 v1.5 (Padding c∆° b·∫£n)</option>
                <option value="oaep">OAEP (Optimal - An to√†n nh·∫•t)</option>
            </select>
            <small class="form-help">
                üí° Raw RSA d·ªÖ b·ªã t·∫•n c√¥ng, PKCS#1 v1.5 an to√†n h∆°n, OAEP l√† chu·∫©n b·∫£o m·∫≠t cao nh·∫•t
            </small>
        </div>

        <button id="encrypt-btn" class="btn btn-primary">M√£ h√≥a</button>

        <div id="encrypt-loading" class="loading">
            <div class="spinner"></div>
            <p>ƒêang m√£ h√≥a...</p>
        </div>

        <div id="encrypt-result" class="result-section" style="display: none;"></div>
    </div>

    <!-- Tab Gi·∫£i m√£ -->
    <div id="decrypt-tab" class="tab-content">
        <h2>üîì Gi·∫£i m√£ RSA</h2>
        <p>Gi·∫£i m√£ b·∫£n m√£ v·ªõi kh√≥a ri√™ng</p>

        <div class="form-group">
            <label class="form-label" for="decrypt-ciphertext">B·∫£n m√£:</label>
            <textarea id="decrypt-ciphertext" class="form-textarea" placeholder="Nh·∫≠p b·∫£n m√£ c·∫ßn gi·∫£i m√£"></textarea>
        </div>

        <div class="form-group">
            <label class="form-label" for="decrypt-n">Modulus (n):</label>
            <textarea id="decrypt-n" class="form-textarea" placeholder="Nh·∫≠p modulus n"></textarea>
        </div>

        <div class="form-group">
            <label class="form-label" for="decrypt-d">S·ªë m≈© ri√™ng (d):</label>
            <textarea id="decrypt-d" class="form-textarea" placeholder="Nh·∫≠p s·ªë m≈© ri√™ng d"></textarea>
        </div>

        <div class="form-group">
            <label class="form-label" for="decrypt-padding">Lo·∫°i Padding:</label>
            <select id="decrypt-padding" class="form-select">
                <option value="raw" selected>Raw RSA (Kh√¥ng padding)</option>
                <option value="pkcs1_v1_5">PKCS#1 v1.5</option>
                <option value="oaep">OAEP</option>
            </select>
            <small class="form-help">
                üí° Ch·ªçn c√πng lo·∫°i padding ƒë∆∞·ª£c s·ª≠ d·ª•ng khi m√£ h√≥a
            </small>
        </div>

        <button id="decrypt-btn" class="btn btn-primary">Gi·∫£i m√£</button>

        <div id="decrypt-loading" class="loading">
            <div class="spinner"></div>
            <p>ƒêang gi·∫£i m√£...</p>
        </div>

        <div id="decrypt-result" class="result-section" style="display: none;"></div>
    </div>

    <!-- Tab T·∫•n c√¥ng khai cƒÉn -->
    <div id="attack-single-tab" class="tab-content">
        <h2>üéØ T·∫•n c√¥ng khai cƒÉn (Cube Root Attack)</h2>
        <p>T·∫•n c√¥ng RSA khi m^e < n</p>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è ƒêi·ªÅu ki·ªán:</strong> T·∫•n c√¥ng n√†y ch·ªâ th√†nh c√¥ng khi b·∫£n r√µ m nh·ªè ƒë·∫øn m·ª©c m^e < n. Th∆∞·ªùng
                        x·∫£y ra v·ªõi e=3 v√† b·∫£n r√µ ng·∫Øn. </div>

                        <div class="form-group">
                            <label class="form-label" for="attack-ciphertext">B·∫£n m√£:</label>
                            <textarea id="attack-ciphertext" class="form-textarea"
                                placeholder="Nh·∫≠p b·∫£n m√£ c·∫ßn t·∫•n c√¥ng"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="attack-n">Modulus (n):</label>
                            <textarea id="attack-n" class="form-textarea" placeholder="Nh·∫≠p modulus n"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="attack-e">S·ªë m≈© c√¥ng khai (e):</label>
                            <input type="text" id="attack-e" class="form-input" placeholder="Nh·∫≠p s·ªë m≈© c√¥ng khai e"
                                value="3">
                        </div>

                        <button id="attack-btn" class="btn btn-danger">B·∫Øt ƒë·∫ßu t·∫•n c√¥ng</button>

                        <div id="attack-loading" class="loading">
                            <div class="spinner"></div>
                            <p>ƒêang th·ª±c hi·ªán t·∫•n c√¥ng...</p>
                        </div>

                        <div id="attack-result" class="result-section" style="display: none;"></div>
                </div>

                <!-- Tab T·∫•n c√¥ng H√•stad -->
                <div id="hastad-tab" class="tab-content">
                    <h2>üö® T·∫•n c√¥ng H√•stad (Broadcast Attack)</h2>
                    <p>T·∫•n c√¥ng khi c√πng b·∫£n r√µ g·ª≠i t·ªõi nhi·ªÅu ng∆∞·ªùi v·ªõi c√πng s·ªë m≈© e</p>

                    <div class="warning-box">
                        <strong>‚ö†Ô∏è ƒêi·ªÅu ki·ªán:</strong> C·∫ßn √≠t nh·∫•t e b·∫£n m√£ c·ªßa c√πng m·ªôt b·∫£n r√µ,
                        ƒë∆∞·ª£c m√£ h√≥a v·ªõi c√°c kh√≥a c√¥ng khai kh√°c nhau nh∆∞ng c√πng s·ªë m≈© e.
                    </div>

                    <!-- Ph·∫ßn t·∫°o demo -->
                    <h3>üìã T·∫°o Demo T·∫•n c√¥ng H√•stad</h3>
                    <p>T·∫°o t·ª± ƒë·ªông c√°c b·∫£n m√£ ƒë·ªÉ minh h·ªça t·∫•n c√¥ng</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label class="form-label" for="hastad-message">B·∫£n r√µ:</label>
                            <input type="text" id="hastad-message" class="form-input" placeholder="Nh·∫≠p b·∫£n r√µ"
                                value="Secret">
                            <small class="form-help">
                                üí° Nh·∫≠p vƒÉn b·∫£n ƒë·ªÉ t·∫°o demo t·∫•n c√¥ng (v√≠ d·ª•: Secret)
                            </small>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="hastad-e">S·ªë m≈© c√¥ng khai (e):</label>
                            <select id="hastad-e" class="form-select">
                                <option value="3" selected>3</option>
                                <option value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="hastad-bits">ƒê·ªô d√†i kh√≥a (bits):</label>
                            <select id="hastad-bits" class="form-select">
                                <option value="512">512</option>
                                <option value="1024" selected>1024</option>
                                <option value="2048">2048</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="hastad-count">S·ªë kh√≥a:</label>
                            <select id="hastad-count" class="form-select">
                                <option value="3" selected>3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="hastad-padding">Lo·∫°i Padding:</label>
                            <select id="hastad-padding" class="form-select">
                                <option value="raw" selected>Raw RSA (C√≥ th·ªÉ t·∫•n c√¥ng)</option>
                                <option value="pkcs1_v1_5">PKCS#1 v1.5 (Ch·ªëng t·∫•n c√¥ng)</option>
                                <option value="oaep">OAEP (Ch·ªëng t·∫•n c√¥ng)</option>
                            </select>
                            <small class="form-help">
                                üí° Ch·ªâ Raw RSA m·ªõi c√≥ th·ªÉ b·ªã t·∫•n c√¥ng H√•stad
                            </small>
                        </div>
                    </div>

                    <button id="hastad-demo-btn" class="btn btn-warning">T·∫°o Demo</button>

                    <div id="hastad-demo-loading" class="loading">
                        <div class="spinner"></div>
                        <p>ƒêang t·∫°o demo...</p>
                    </div>

                    <div id="hastad-demo-result" class="result-section" style="display: none;"></div>

                    <!-- Ph·∫ßn th·ª±c hi·ªán t·∫•n c√¥ng -->
                    <h3>‚öîÔ∏è Th·ª±c hi·ªán T·∫•n c√¥ng H√•stad</h3>

                    <div class="form-group">
                        <label class="form-label" for="hastad-ciphertexts">C√°c b·∫£n m√£ (m·ªói d√≤ng m·ªôt b·∫£n m√£):</label>
                        <textarea id="hastad-ciphertexts" class="form-textarea" rows="5"
                            placeholder="Nh·∫≠p c√°c b·∫£n m√£, m·ªói d√≤ng m·ªôt b·∫£n m√£&#10;V√≠ d·ª•:&#10;123456789&#10;987654321&#10;555666777"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="hastad-keys">C√°c kh√≥a c√¥ng khai (m·ªói d√≤ng: n,e):</label>
                        <textarea id="hastad-keys" class="form-textarea" rows="5"
                            placeholder="Nh·∫≠p c√°c kh√≥a c√¥ng khai, m·ªói d√≤ng ƒë·ªãnh d·∫°ng: n,e&#10;V√≠ d·ª•:&#10;12345,3&#10;67890,3&#10;11111,3"></textarea>
                    </div>

                    <button id="hastad-attack-btn" class="btn btn-danger">B·∫Øt ƒë·∫ßu t·∫•n c√¥ng H√•stad</button>

                    <div id="hastad-attack-loading" class="loading">
                        <div class="spinner"></div>
                        <p>ƒêang th·ª±c hi·ªán t·∫•n c√¥ng H√•stad...</p>
                    </div>

                    <div id="hastad-attack-result" class="result-section" style="display: none;"></div>
                </div>
    </div>

    <div class="demo-container">
        <h2>üîê Ph√¢n t√≠ch c√°c lo·∫°i m√£ h√≥a RSA</h2>
        <div
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1rem;">

            <div class="attack-example" style="border-left: 4px solid #ff4444;">
                <h3>‚ö†Ô∏è Raw RSA (Textbook RSA)</h3>
                <p><strong>C√¥ng th·ª©c:</strong> c = m^e mod n</p>
                <p><strong>ƒê·∫∑c ƒëi·ªÉm:</strong></p>
                <ul>
                    <li>Kh√¥ng c√≥ padding</li>
                    <li>M√£ h√≥a tr·ª±c ti·∫øp</li>
                    <li>Deterministic (c√πng input ‚Üí c√πng output)</li>
                </ul>
                <p><strong>‚ö†Ô∏è L·ªó h·ªïng b·∫£o m·∫≠t:</strong></p>
                <ul>
                    <li>Cube root attack khi m^e < n</li>
                    <li>H√•stad attack v·ªõi nhi·ªÅu kh√≥a</li>
                    <li>Chosen plaintext attack</li>
                    <li>Malleable (c√≥ th·ªÉ thay ƒë·ªïi)</li>
                </ul>
                <p><strong>K·∫øt lu·∫≠n:</strong> <span style="color: #ff4444; font-weight: bold;">KH√îNG AN TO√ÄN - ch·ªâ d√πng
                        ƒë·ªÉ demo</span></p>
            </div>

            <div class="attack-example" style="border-left: 4px solid #ffaa00;">
                <h3>üõ°Ô∏è PKCS#1 v1.5</h3>
                <p><strong>C√¥ng th·ª©c:</strong> c = (0x00 || 0x02 || PS || 0x00 || M)^e mod n</p>
                <p><strong>ƒê·∫∑c ƒëi·ªÉm:</strong></p>
                <ul>
                    <li>Th√™m random padding</li>
                    <li>Structured padding scheme</li>
                    <li>ƒê∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i</li>
                </ul>
                <p><strong>üîí B·∫£o m·∫≠t:</strong></p>
                <ul>
                    <li>Ch·ªëng cube root attack</li>
                    <li>TƒÉng entropy</li>
                    <li>Non-deterministic</li>
                </ul>
                <p><strong>‚ö†Ô∏è H·∫°n ch·∫ø:</strong></p>
                <ul>
                    <li>C√≥ th·ªÉ b·ªã Bleichenbacher attack</li>
                    <li>C·∫ßn timing attack protection</li>
                </ul>
                <p><strong>K·∫øt lu·∫≠n:</strong> <span style="color: #ffaa00; font-weight: bold;">AN TO√ÄN V·ª™A PH·∫¢I - legacy
                        standard</span></p>
            </div>

            <div class="attack-example" style="border-left: 4px solid #00aa44;">
                <h3>üîí OAEP (Optimal Asymmetric Encryption Padding)</h3>
                <p><strong>C√¥ng th·ª©c:</strong> Ph·ª©c t·∫°p v·ªõi hash functions v√† mask generation</p>
                <p><strong>ƒê·∫∑c ƒëi·ªÉm:</strong></p>
                <ul>
                    <li>S·ª≠ d·ª•ng hash functions (SHA-256)</li>
                    <li>Mask Generation Function (MGF)</li>
                    <li>Provably secure</li>
                </ul>
                <p><strong>üîí B·∫£o m·∫≠t cao:</strong></p>
                <ul>
                    <li>IND-CCA2 secure</li>
                    <li>Ch·ªëng m·ªçi known attacks</li>
                    <li>Random oracle model proof</li>
                    <li>Non-malleable</li>
                </ul>
                <p><strong>‚úÖ ∆Øu ƒëi·ªÉm:</strong></p>
                <ul>
                    <li>An to√†n nh·∫•t hi·ªán t·∫°i</li>
                    <li>Chu·∫©n khuy·∫øn ngh·ªã</li>
                    <li>ƒê∆∞·ª£c RFC ƒë·ªãnh nghƒ©a</li>
                </ul>
                <p><strong>K·∫øt lu·∫≠n:</strong> <span style="color: #00aa44; font-weight: bold;">R·∫§T AN TO√ÄN - recommended
                        standard</span></p>
            </div>
        </div>

        <div class="warning-box" style="margin-top: 2rem;">
            <h3>üìã Khuy·∫øn ngh·ªã s·ª≠ d·ª•ng:</h3>
            <ul>
                <li><strong>Demo/H·ªçc t·∫≠p:</strong> Raw RSA ƒë·ªÉ hi·ªÉu c√°c l·ªó h·ªïng</li>
                <li><strong>H·ªá th·ªëng legacy:</strong> PKCS#1 v1.5 v·ªõi c·∫£nh b√°o</li>
                <li><strong>·ª®ng d·ª•ng th·ª±c t·∫ø:</strong> OAEP v·ªõi SHA-256</li>
                <li><strong>T∆∞∆°ng lai:</strong> Chuy·ªÉn sang post-quantum cryptography</li>
            </ul>
        </div>
    </div>

    <div class="demo-container">
        <h2>üìù H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
            <div class="attack-example">
                <h3>1Ô∏è‚É£ Sinh kh√≥a</h3>
                <p>Ch·ªçn e = 3 v√† ƒë·ªô d√†i kh√≥a ph√π h·ª£p. Kh√≥a ƒë∆∞·ª£c t·∫°o s·∫Ω t·ª± ƒë·ªông ƒëi·ªÅn v√†o c√°c tab kh√°c.</p>
            </div>

            <div class="attack-example">
                <h3>2Ô∏è‚É£ M√£ h√≥a</h3>
                <p>Nh·∫≠p b·∫£n r√µ ng·∫Øn (nh∆∞ "Hi", "Hello") ƒë·ªÉ t·∫°o ƒëi·ªÅu ki·ªán m^e < n cho t·∫•n c√¥ng.</p>
            </div>

            <div class="attack-example">
                <h3>3Ô∏è‚É£ T·∫•n c√¥ng</h3>
                <p>Th·ª≠ t·∫•n c√¥ng khai cƒÉn v·ªõi b·∫£n m√£ v·ª´a t·∫°o. N·∫øu th√†nh c√¥ng, b·∫£n r√µ s·∫Ω ƒë∆∞·ª£c kh√¥i ph·ª•c.</p>
            </div>

            <div class="attack-example">
                <h3>4Ô∏è‚É£ H√•stad</h3>
                <p>T·∫°o demo t·ª± ƒë·ªông ho·∫∑c nh·∫≠p th·ªß c√¥ng c√°c b·∫£n m√£ ƒë·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng H√•stad.</p>
            </div>
        </div>
    </div>
    {% endblock %}